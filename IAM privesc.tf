terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~> 5.0"
    }
  }
}

provider "aws" {
  region = "us-west-2"
//You need to create an IAM User with Administrator access permission and link the access key of the IAM user locally to your PC by running the command on CMD or terminal "aws configure --profile <name-of-your-choice>" 
  profile = "goody-terra" 
}

resource "aws_iam_user" "dave" {
  name = "Dave"
}

resource "aws_iam_user" "bob" {
  name = "Bob"
}

resource "aws_iam_access_key" "bob_user_key" {
  user    = aws_iam_user.bob.name
}

resource "aws_iam_user_policy" "bob_custom_policy" {
  name = "BobCustomPolicy"
  user = aws_iam_user.bob.name

  policy = <<EOF
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "Statement1",
      "Effect": "Allow",
      "Action": [
          "iam:Get*",
          "iam:List*",
          "iam:Put*",
          "iam:SimulateCustomPolicy",
          "iam:SimulatePrincipalPolicy"
      ],
      "Resource": "*"
    }
  ]
}
EOF
}

resource "aws_iam_user_policy_attachment" "dave_admin_policy" {
  user       = aws_iam_user.dave.name
  policy_arn = "arn:aws:iam::aws:policy/AdministratorAccess"
}

// Output of Access Key Creds for Bob
output "access_key_id" {
  value     = aws_iam_access_key.bob_user_key.id
  sensitive = true
}

output "secret_access_key" {
  value     = aws_iam_access_key.bob_user_key.secret
  sensitive = true
} 
